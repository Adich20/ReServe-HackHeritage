<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <title>ReServe – Smarter Surplus Food Distribution</title>

  <!-- Prevent flash: apply stored/system theme BEFORE CSS paints -->
  <script>
    (function () {
      try {
        const ls = localStorage.getItem('theme');
        const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        if (ls === 'dark' || (!ls && systemDark)) {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
      } catch (e) {}
    })();
  </script>

  <!-- Tailwind CDN -->
   <script src="https://cdn.tailwindcss.com"></script>

 <!-- 2) Enable dark mode via class strategy for all dark: variants -->
  <script>
    tailwind.config = {
      darkMode: 'class'
    };
  </script>

  <!-- AOS Library -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="style.css">
  <style>
    /* Chatbot Icon */
    #chatbot-icon {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: var(--color-primary);
      color: white;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transition: transform 0.3s ease, background-color 0.3s ease;
      z-index: 1000;
    }
    #chatbot-icon:hover {
      transform: scale(1.1);
      background-color: #27ae60;
    }

    /* Chatbot Container */
    #chatbot-container {
      position: fixed;
      bottom: 90px;
      right: 20px;
      width: 360px;
      max-width: 90vw;
      height: 500px;
      max-height: 80vh;
      background-color: white;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transform: translateY(100vh);
      transition: transform 0.3s ease-in-out;
      z-index: 1000;
      font-family: 'Inter', sans-serif;
    }
    #chatbot-container.open {
      transform: translateY(0);
    }
    .dark #chatbot-container {
      background-color: #1F2937;
    }

    /* Chatbot Header */
    #chatbot-header {
      background-color: var(--color-primary);
      color: white;
      padding: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      font-size: 18px;
    }
    #close-btn {
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      transition: color 0.3s ease;
    }
    #close-btn:hover {
      color: #F1C40F;
    }

    /* Chatbot Body */
    #chatbot-body {
      flex: 1;
      padding: 16px;
      overflow-y: auto;
      background-color: #F9FAFB;
    }
    .dark #chatbot-body {
      background-color: #374151;
    }
    #chatbot-messages {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .message {
      max-width: 80%;
      padding: 10px 14px;
      border-radius: 12px;
      font-size: 14px;
      line-height: 1.4;
    }
    .message.user {
      align-self: flex-end;
      background-color: var(--color-primary);
      color: white;
      border-bottom-right-radius: 4px;
    }
    .message.ai {
      align-self: flex-start;
      background-color: #E5E7EB;
      color: #1F2937;
      border-bottom-left-radius: 4px;
    }
    .dark .message.ai {
      background-color: #4B5563;
      color: #F9FAFB;
    }

    /* Typing Animation */
    .message.typing {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 10px 14px;
      background-color: #E5E7EB;
      border-radius: 12px;
      border-bottom-left-radius: 4px;
      align-self: flex-start;
      max-width: 80%;
    }
    .dark .message.typing {
      background-color: #4B5563;
    }
    .typing-dot {
      width: 8px;
      height: 8px;
      background-color: #6B7280;
      border-radius: 50%;
      animation: typing 1.4s infinite;
    }
    .dark .typing-dot {
      background-color: #9CA3AF;
    }
    .typing-dot:nth-child(2) {
      animation-delay: 0.2s;
    }
    .typing-dot:nth-child(3) {
      animation-delay: 0.4s;
    }
    @keyframes typing {
      0%, 80%, 100% {
        transform: translateY(0);
        opacity: 0.4;
      }
      40% {
        transform: translateY(-4px);
        opacity: 1;
      }
    }

    /* Chatbot Footer */
    #chatbot-footer {
      padding: 12px;
      background-color: white;
      border-top: 1px solid #E5E7EB;
      display: flex;
      gap: 8px;
    }
    .dark #chatbot-footer {
      background-color: #1F2937;
      border-top: 1px solid #4B5563;
    }
    #chatbot-input {
      flex: 1;
      padding: 10px;
      border: 1px solid #D1D5DB;
      border-radius: 8px;
      font-size: 14px;
      outline: none;
      transition: border-color 0.3s ease;
    }
    #chatbot-input:focus {
      border-color: var(--color-primary);
    }
    .dark #chatbot-input {
      background-color: #374151;
      border-color: #4B5563;
      color: #F9FAFB;
    }
    #send-btn {
      background-color: var(--color-primary);
      color: white;
      padding: 10px 16px;
      border-radius: 8px;
      border: none;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    #send-btn:hover {
      background-color: #27ae60;
    }
  </style>
</head>

<body class="antialiased text-neutral bg-white dark:bg-gray-900 dark:text-gray-100 transition-colors">
  <!-- ================= NAVBAR ================= -->
  <header class="sticky top-0 z-40 border-b border-gray-100/70 bg-white/80 backdrop-blur dark:bg-gray-800/80 dark:border-gray-700" data-aos="fade-down">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex h-16 items-center justify-between">
        <!-- Brand -->
        <a href="#" class="flex items-center gap-2">
          <img src="logo.png" alt="ReServe logo" class="h-14 w-14 rounded-md shadow" />
          <span class="font-bold text-lg tracking-tight">Re<span class="text-primary">Serve</span></span>
        </a>

        <!-- Desktop Nav -->
        <nav class="hidden md:flex items-center gap-6">
          <a href="how-it-works.html" class="hover:text-primary transition">How it works</a>
          <a href="features.html" class="hover:text-primary transition">Features</a>
          <a href="#impact" class="hover:text-primary transition">Impact</a>
          <a href="#partners" class="hover:text-primary transition">Partners</a>
        </nav>

        <!-- CTAs + Dark Mode -->
        <div class="hidden md:flex items-center gap-3">
          <button id="darkToggle" aria-label="Toggle dark mode" class="px-3 py-2 rounded-lg border border-gray-200 hover:border-primary hover:text-primary transition dark:border-gray-700">🌙</button>
          <a href="#demo" class="px-4 py-2 rounded-lg border border-gray-200 hover:border-primary hover:text-primary transition dark:border-gray-700">View Demo</a>
          <a href="#signup" class="px-4 py-2 rounded-lg bg-primary text-white font-semibold hover:opacity-90 transition">Get Started</a>
        </div>

        <!-- Mobile menu button -->
        <button id="menuBtn" class="md:hidden inline-flex items-center justify-center p-2 rounded-lg border border-gray-200 hover:border-primary hover:text-primary transition dark:border-gray-700" aria-label="Open menu">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
        </button>
      </div>
    </div>

    <!-- Mobile Drawer -->
    <div id="mobileMenu" class="md:hidden hidden border-t border-gray-100 bg-white dark:bg-gray-800 dark:border-gray-700">
      <nav class="px-4 py-3 space-y-2">
        <a href="how-it-works.html" class="block py-2 hover:text-primary">How it works</a>
        <a href="features.html" class="block py-2 hover:text-primary">Features</a>
        <a href="#impact" class="block py-2 hover:text-primary">Impact</a>
        <a href="#partners" class="block py-2 hover:text-primary">Partners</a>
        <div class="pt-2 flex gap-2">
          <a href="#demo" class="flex-1 px-4 py-2 rounded-lg border border-gray-200 text-center hover:border-primary hover:text-primary dark:border-gray-700">View Demo</a>
          <a href="#signup" class="flex-1 px-4 py-2 rounded-lg bg-primary text-white text-center font-semibold">Get Started</a>
        </div>
      </nav>
    </div>
  </header>


  <!-- ================= HERO ================= -->
  <section class="relative overflow-hidden" data-aos="fade-up">
    <div class="absolute inset-0 -z-10 bg-gradient-to-b from-[color:var(--color-secondary)] via-white to-[color:var(--color-primary)] opacity-20 dark:opacity-30"></div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 md:py-28">
      <div class="grid md:grid-cols-2 gap-10 items-center">
        <div>
          <h1 class="text-4xl md:text-5xl font-extrabold leading-tight">
            Smarter Surplus Food Distribution for a
            <span class="text-primary">Zero-Waste</span> Community
          </h1>
          <p class="mt-5 text-lg text-[color:var(--color-neutral-80)] dark:text-gray-300">
            ReServe connects restaurants and grocers with local shelters & food banks using real-time listing, smart routing, and transparent tracking.
          </p>
          <div class="mt-8 flex flex-wrap gap-3">
            <a href="#signup" class="px-6 py-3 rounded-xl bg-accent1 text-white font-semibold shadow hover:translate-y-[1px] transition">Become a Donor</a>
            <a href="#signup" class="px-6 py-3 rounded-xl bg-accent2 text-white font-semibold shadow hover:translate-y-[1px] transition">Join as Recipient</a>
            <a href="#demo" class="px-6 py-3 rounded-xl border border-gray-200 hover:border-primary hover:text-primary transition dark:border-gray-700">See a Live Demo</a>
          </div>
        </div>

        <!-- Hero Illustration -->
        <div class="relative">
          <img src="https://dummyimage.com/500x350/edf2f7/333&text=🍲+Live+Food+Board" alt="Live Food Board illustration" class="rounded-2xl shadow border border-gray-200 dark:border-gray-700" />
          <div class="absolute -bottom-6 -right-6 h-24 w-24 bg-accent2/20 blur-2xl rounded-full"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- ================= IMPACT STATS ================= -->
  <section id="impact" class="py-16 md:py-20 bg-[color:var(--color-surface)] dark:bg-gray-800" data-aos="fade-up">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-3xl md:text-4xl font-bold text-center">Real Impact, <span class="text-secondary">Every Day</span></h2>
      <div class="mt-12 grid sm:grid-cols-3 gap-6 text-center">
        <div class="rounded-2xl border border-gray-200 bg-white dark:bg-gray-700 dark:border-gray-700 p-8">
          <p class="text-4xl font-extrabold text-primary counter" data-target="12480">0</p>
          <p class="mt-2 text-sm text-[color:var(--color-neutral-80)] dark:text-gray-300">Meals redistributed</p>
        </div>
        <div class="rounded-2xl border border-gray-200 bg-white dark:bg-gray-700 dark:border-gray-700 p-8">
          <p class="text-4xl font-extrabold text-secondary counter" data-target="7.9">0</p>
          <p class="mt-2 text-sm text-[color:var(--color-neutral-80)] dark:text-gray-300">CO₂ avoided (t)</p>
        </div>
        <div class="rounded-2xl border border-gray-200 bg-white dark:bg-gray-700 dark:border-gray-700 p-8">
          <p class="text-4xl font-extrabold text-accent2 counter" data-target="98">0%</p>
          <p class="mt-2 text-sm text-[color:var(--color-neutral-80)] dark:text-gray-300">Safe delivery compliance</p>
        </div>
      </div>
    </div>
  </section>

  <!-- ================= PARTNERS ================= -->
  <section id="partners" class="py-16 md:py-20" data-aos="fade-up">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-3xl md:text-4xl font-bold text-center">Built with the <span class="text-accent1">Community</span></h2>
      <p class="mt-3 text-center text-[color:var(--color-neutral-80)] dark:text-gray-300">Local restaurants, grocers, shelters & NGOs.</p>

      <div class="mt-10 grid grid-cols-2 md:grid-cols-4 gap-6 items-center">
        <div class="rounded-xl border border-gray-200 bg-white/60 p-4 text-center font-semibold text-gray-600 dark:border-gray-700 dark:bg-gray-700/60 dark:text-gray-200">NGO</div>
        <div class="rounded-xl border border-gray-200 bg-white/60 p-4 text-center font-semibold text-gray-600 dark:border-gray-700 dark:bg-gray-700/60 dark:text-gray-200">Restaurant</div>
        <div class="rounded-xl border border-gray-200 bg-white/60 p-4 text-center font-semibold text-gray-600 dark:border-gray-700 dark:bg-gray-700/60 dark:text-gray-200">Shelter</div>
        <div class="rounded-xl border border-gray-200 bg-white/60 p-4 text-center font-semibold text-gray-600 dark:border-gray-700 dark:bg-gray-700/60 dark:text-gray-200">Grocer</div>
      </div>
    </div>
  </section>

  <!-- ================= SIGNUP ================= -->
  <section id="signup" class="py-16 md:py-20 bg-gradient-to-b from-white via-[color:var(--color-secondary)]/10 to-[color:var(--color-primary)]/10 dark:from-gray-900 dark:via-gray-800 dark:to-gray-700" data-aos="fade-up">
    <div class="max-w-lg mx-auto px-4 sm:px-6">
      <div class="rounded-2xl border border-gray-200 bg-white dark:bg-gray-800 dark:border-gray-700 p-6 md:p-8 shadow-sm">
        <h3 class="text-2xl font-bold text-center">Get Started with ReServe</h3>
        <p class="mt-2 text-center text-[color:var(--color-neutral-80)] dark:text-gray-300">Create an account as a donor or recipient.</p>

        <form id="signupForm" class="mt-6 space-y-4">
          <div class="grid grid-cols-2 gap-3">
            <label class="flex items-center gap-2 rounded-lg border border-gray-200 p-3 cursor-pointer hover:border-primary dark:border-gray-700">
              <input type="radio" name="role" value="donor" class="accent-[var(--color-primary)] ring-brand" checked>
              <span>Donor</span>
            </label>
            <label class="flex items-center gap-2 rounded-lg border border-gray-200 p-3 cursor-pointer hover:border-primary dark:border-gray-700">
              <input type="radio" name="role" value="recipient" class="accent-[var(--color-primary)] ring-brand">
              <span>Recipient</span>
            </label>
          </div>

          <input type="text" id="org" placeholder="Organization name" required class="w-full rounded-lg border border-gray-200 p-3 focus:outline-none focus:ring-2 focus:ring-[color:var(--color-primary)]/40 dark:border-gray-700" />
          <input type="email" id="email" placeholder="Work email" required class="w-full rounded-lg border border-gray-200 p-3 focus:outline-none focus:ring-2 focus:ring-[color:var(--color-primary)]/40 dark:border-gray-700" />
          <div class="grid grid-cols-2 gap-3">
            <input type="password" id="pass" placeholder="Password" required class="w-full rounded-lg border border-gray-200 p-3 focus:outline-none focus:ring-2 focus:ring-[color:var(--color-primary)]/40 dark:border-gray-700" />
            <input type="password" id="confirm" placeholder="Confirm" required class="w-full rounded-lg border border-gray-200 p-3 focus:outline-none focus:ring-2 focus:ring-[color:var(--color-primary)]/40 dark:border-gray-700" />
          </div>

          <button type="submit" class="w-full mt-2 px-4 py-3 rounded-lg bg-accent1 text-white font-semibold hover:opacity-90 transition">Create Account</button>

          <!-- ADDED: Login button (clickable) - placed just below Create Account -->
          <button type="button" id="loginBtn" aria-label="Go to login" class="w-full mt-3 px-4 py-3 rounded-lg border border-gray-200 bg-white text-primary font-semibold hover:bg-primary hover:text-white transition dark:bg-gray-700 dark:text-gray-100 dark:border-gray-700">
            Already have an account? Log in
          </button>

          <p class="text-xs text-center text-[color:var(--color-neutral-80)] dark:text-gray-400">By signing up you agree to our terms & privacy policy.</p>
        </form>
      </div>
    </div>
  </section>

  <!-- ================= FOOTER ================= -->
  <footer class="border-t border-gray-100 dark:border-gray-700" data-aos="fade-up">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
      <div class="flex flex-col md:flex-row items-center justify-between gap-4">
        <div class="flex items-center gap-2">
          <img src="https://dummyimage.com/28x28/2ECC71/ffffff.png&text=R" alt="ReServe logo" class="h-7 w-7 rounded-md shadow" />
          <span class="font-semibold">Re<span class="text-primary">Serve</span></span>
        </div>
        <p class="text-sm text-[color:var(--color-neutral-80)] dark:text-gray-400">© 2025 ReServe — Built for trust, freshness & community.</p>
      </div>
    </div>
  </footer>

  <!-- Chatbot -->
  <div id="chatbot-icon">💬</div>
  <div id="chatbot-container">
    <div id="chatbot-header">
      <span>ReServe Assistant</span>
      <button id="close-btn">&times;</button>
    </div>
    <div id="chatbot-body">
      <div id="chatbot-messages"></div>
    </div>
    <div id="chatbot-footer">
      <input type="text" id="chatbot-input" placeholder="Type a message..." />
      <button id="send-btn">Send</button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="script.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
  <script>
    AOS.init({ duration: 1000, easing: 'ease-out-cubic', once: true });

    // Chatbot Functionality
    const chatbotIcon = document.getElementById('chatbot-icon');
    const chatbotContainer = document.getElementById('chatbot-container');
    const closeBtn = document.getElementById('close-btn');
    const sendBtn = document.getElementById('send-btn');
    const chatbotInput = document.getElementById('chatbot-input');
    const chatbotMessages = document.getElementById('chatbot-messages');
    let isFirstOpen = true;

    // Conversation History for Memory
    let conversationHistory = [
      {
        role: "user",
        parts: [{ text: "You are a Food Redistribution Assistant for the ReServe website. Help people find NGOs, food banks, or shelters to donate their extra food. Also, guide users on how to use the webpage properly, such as signing up as a donor or recipient, viewing the demo, navigating sections like 'How it works', 'Features', 'Impact', and 'Partners'. Be polite, short, and helpful." }]
      },
      {
        role: "model",
        parts: [{ text: "Understood." }]
      }
    ];

    // Initial Welcome Message
    const initialMessage = "👋 Hi! I’m your Food Redistribution Assistant.\nI can help you find NGOs, shelters, or restaurants to donate excess food, and guide you on using the ReServe webpage.";

    // Toggle Chatbot and Show Initial Message
    chatbotIcon.addEventListener('click', () => {
      chatbotContainer.classList.toggle('open');
      if (isFirstOpen && chatbotContainer.classList.contains('open')) {
        const aiMessage = document.createElement('div');
        aiMessage.className = 'message ai';
        aiMessage.textContent = initialMessage;
        chatbotMessages.appendChild(aiMessage);
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;

        // Add initial message to history
        conversationHistory.push({
          role: "model",
          parts: [{ text: initialMessage }]
        });

        isFirstOpen = false;
      }
    });
    closeBtn.addEventListener('click', () => {
      chatbotContainer.classList.remove('open');
    });

    // Handle Message Sending
    sendBtn.addEventListener('click', sendMessage);
    chatbotInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') sendMessage();
    });

    async function sendMessage() {
      const message = chatbotInput.value.trim();
      if (!message) return;

      // Add User Message to Display
      const userMessage = document.createElement('div');
      userMessage.className = 'message user';
      userMessage.textContent = message;
      chatbotMessages.appendChild(userMessage);
      chatbotInput.value = '';
      chatbotMessages.scrollTop = chatbotMessages.scrollHeight;

      // Add User Message to History
      conversationHistory.push({
        role: "user",
        parts: [{ text: message }]
      });

      // Show Typing Animation
      const typingIndicator = document.createElement('div');
      typingIndicator.className = 'message typing';
      typingIndicator.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
      chatbotMessages.appendChild(typingIndicator);
      chatbotMessages.scrollTop = chatbotMessages.scrollHeight;

      try {
        // Gemini API Call with Full History
        const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=AIzaSyBSPLXAgMdnDy7MaYvZVv3VPYsv39aMiT8', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            contents: conversationHistory
          })
        });

        const data = await response.json();
        const aiResponse = data.candidates?.[0]?.content?.parts?.[0]?.text || 'Sorry, I couldn’t process your request. Try again!';

        // Remove Typing Animation
        typingIndicator.remove();

        // Add AI Response to Display
        const aiMessage = document.createElement('div');
        aiMessage.className = 'message ai';
        aiMessage.textContent = aiResponse;
        chatbotMessages.appendChild(aiMessage);
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;

        // Add AI Response to History
        conversationHistory.push({
          role: "model",
          parts: [{ text: aiResponse }]
        });
      } catch (error) {
        // Remove Typing Animation
        typingIndicator.remove();

        // Fallback Dummy Response on Error
        const aiMessage = document.createElement('div');
        aiMessage.className = 'message ai';
        aiMessage.textContent = 'Sorry, something went wrong. Please try again!';
        chatbotMessages.appendChild(aiMessage);
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;

        // Still add to history for consistency
        conversationHistory.push({
          role: "model",
          parts: [{ text: 'Sorry, something went wrong. Please try again!' } ]
        });
      }
    }
  </script>
</body>
</html>
